{"ast":null,"code":"import { mapActions } from \"vuex\";\nlet {\n  url,\n  endpointCodes\n} = require(\"../../global/index\");\nexport default {\n  name: \"AddPrd\",\n  data() {\n    return {\n      urlr: url,\n      endpointCodes: endpointCodes,\n      status: \"\",\n      message: \"\",\n      name: \"\",\n      descr: \"\",\n      id_category: \"\",\n      id_type: \"\",\n      price: \"\",\n      more_pro: \"NO\",\n      cat_name: \"NINGUNA\",\n      type_name: \"NINGUNA\",\n      sub_name: \"NINGUNA\",\n      id_subcategory: \"\",\n      subcat: [],\n      itemsub: \"\",\n      url: \"\",\n      search_value: \"\",\n      updsearchcli: \"\",\n      price_ext: \"\",\n      descr_ext: \"\",\n      extras: [],\n      active: false,\n      active2: false,\n      value1: \"\",\n      value2: \"\",\n      value3: \"\",\n      archivo: \"No se eligió archivo\",\n      file1: null,\n      //MODAL\n\n      viewModal: false\n    };\n  },\n  created() {\n    this.getAllInfoCtg(\"category\");\n    //this.getAllInfoTpe(\"type\");\n  },\n\n  watch: {\n    id_category: async function (value) {\n      this.subcat = [];\n      if (value) {\n        const payload2 = {\n          id: value,\n          option: \"category_subcategory\"\n        };\n        await this.getInfoByIdSct(payload2);\n      }\n    }\n  },\n  computed: {\n    added() {\n      return this.$store.getters[\"product/getAdded\"];\n    },\n    categorias() {\n      let arr = this.$store.getters[\"category/data\"];\n      if (Array.isArray(arr)) {\n        return arr;\n      } else {\n        return [];\n      }\n    },\n    subcategorias() {\n      let arr = this.$store.getters[\"subcategory/data\"];\n      if (Array.isArray(arr)) {\n        return arr;\n      } else {\n        return [];\n      }\n    }\n    /*type() {\r\n      let arr =  this.$store.getters[\"type/data\"];\r\n       if(Array.isArray(arr)){\r\n        return arr\r\n      }else{\r\n        return []\r\n      }\r\n    },*/\n  },\n\n  methods: {\n    ...mapActions(\"product\", [\"getAllInfoPrd\"]),\n    ...mapActions(\"product\", [\"setAddedPrd\"]),\n    ...mapActions(\"product\", [\"setHistoryOptionPrd\"]),\n    ...mapActions(\"product\", [\"getInfoByIdPrd\"]),\n    ...mapActions(\"category\", [\"getAllInfoCtg\"]),\n    ...mapActions(\"category\", [\"setAddedCtg\"]),\n    ...mapActions(\"category\", [\"setHistoryOptionCtg\"]),\n    ...mapActions(\"type\", [\"getAllInfoTpe\"]),\n    ...mapActions(\"type\", [\"setAddedTpe\"]),\n    ...mapActions(\"type\", [\"setHistoryOptionTpe\"]),\n    ...mapActions(\"subcategory\", [\"getInfoByIdSct\"]),\n    wait: function () {\n      setTimeout(() => this.$router.go(), 200);\n    },\n    addSubcategory(item) {\n      this.subcat = [item];\n      this.itemsub = \"\";\n      this.sub_name = \"NINGUNA\";\n      this.id_subcategory = \"\";\n    },\n    submit: async function (name, id_category, descr, price, image, extras, subcat, more_pro) {\n      this.status = \"\";\n      this.message = \"\";\n      let data = [];\n      extras = JSON.stringify(extras);\n      subcat = JSON.stringify(subcat);\n      let p = price;\n      if (more_pro == 'SI') {\n        p = 1;\n      }\n      if (image == null) {\n        data = {\n          name: name,\n          id_category: id_category,\n          descr: descr,\n          price: p,\n          extras,\n          subcat,\n          more_pro\n        };\n      } else {\n        data = new FormData();\n        data.append(\"name\", name);\n        data.append(\"id_category\", id_category);\n        data.append(\"descr\", descr);\n        data.append(\"price\", p);\n        data.append(\"image\", image);\n        data.append(\"subcat\", subcat);\n        data.append(\"extras\", extras);\n        data.append(\"more_pro\", more_pro);\n        data.append(\"_method\", \"POST\");\n      }\n      let result = await this.$store.dispatch(\"product/addItemPrd\", {\n        option: \"product\",\n        item: data\n      });\n      console.log(result);\n      if (result.status == \"error\") {\n        this.status = \"error\";\n        this.message = result.message;\n      } else {\n        // success\n        let payload = {\n          id: result.added.id,\n          option: \"product\"\n        };\n        let arrl = await this.getInfoByIdPrd(payload);\n        this.setAddedPrd(arrl);\n        /**/\n        if (arrl.more_pro == true) {\n          this.active2 = true;\n        }\n        this.showModal();\n      }\n    },\n    closeSelect() {\n      this.active = false;\n      document.getElementById(\"select-ch\").checked = false;\n    },\n    /* \r\n        addExtra(price, descr) {\r\n          let arr = [];\r\n          for (const item of this.extras) {\r\n            arr.push(item);\r\n          }\r\n          arr.push({\r\n            price,\r\n            descr,\r\n          });\r\n          this.extras = arr;\r\n        },\r\n        delExtra(indice) {\r\n          let arr = [];\r\n          for (var i = 0; i < this.extras.length; i++) {\r\n            if (i != indice) {\r\n              arr.push(this.extras[i]);\r\n            }\r\n          }\r\n          this.extras = arr;\r\n        },*/\n\n    includesItem(search, name) {\n      if (search == \"\") {\n        return true;\n      }\n      name = name.toLowerCase();\n      search = search.toLowerCase();\n      if (search == \"\") {\n        return false;\n      }\n      return name.includes(search);\n    },\n    includesItem2(search, name) {\n      if (search == \"\") {\n        return true;\n      }\n      name = name.toLowerCase();\n      search = search.toLowerCase();\n      if (search == \"\") {\n        return false;\n      }\n      return name.includes(search);\n    },\n    showModal: function () {\n      this.viewModal = true;\n    },\n    closeModal: function () {\n      this.viewModal = false;\n      this.setAddedPrd(\"\");\n      this.setHistoryOptionPrd(\"Default\");\n    },\n    Add: function () {\n      this.status = \"\";\n      this.message = \"\";\n      this.name = \"\";\n      this.id_category = \"\";\n      this.id_type = \"\";\n      this.cat_name = \"NINGUNA\";\n      this.type_name = \"NINGUNA\";\n      this.descr = \"\";\n      this.price = \"\";\n      this.file1 = null;\n      this.viewModal = false;\n      this.setAddedPrd(\"\");\n    },\n    toEdit: function () {\n      this.setHistoryOptionPrd(\"Edit\");\n      this.viewModal = false;\n    },\n    back: function () {\n      setTimeout(() => this.$router.go(), 200);\n    },\n    previewFiles(e) {\n      var files = e.target.files || e.dataTransfer.files;\n      if (!files.length) return;\n      this.file1 = files[0];\n      this.archivo = this.file1.name;\n    }\n  }\n};","map":{"version":3,"mappings":"AA+aA;AACA;EAAAA;EAAAC;AAAA;AACA;EACAC;EACAC;IACA;MACAC;MACAH;MACAI;MACAC;MAEAJ;MACAK;MACAC;MACAC;MACAC;MACAC;MAEAC;MACAC;MAEAC;MACAC;MACAC;MACAC;MAEAjB;MAEAkB;MACAC;MAEAC;MACAC;MACAC;MAEAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MAEA;;MAEAC;IACA;EACA;EACAC;IACA;IACA;EACA;;EACAC;IACAxB;MACA;MACA;QACA;UACAyB;UACAC;QACA;QACA;MACA;IACA;EACA;EAEAC;IACAC;MACA;IACA;IACAC;MACA;MACA;QACA;MACA;QACA;MACA;IACA;IACAC;MACA;MACA;QACA;MACA;QACA;MACA;IACA;IACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACA;;EACAC;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACAC;MACAC;IACA;IACAC;MACA;MACA;MACA;MACA;IACA;IACAC,wBACAzC,MACAM,aACAD,OACAG,OACAkC,OACAtB,QACAN,QACAL,UACA;MACA;MACA;MACA;MACAW;MACAN;MACA;MACA;QACA6B;MACA;MACA;QACA1C;UACAD;UACAM;UACAD;UACAG;UACAY;UACAN;UACAL;QACA;MACA;QACAR;QACAA;QACAA;QAEAA;QACAA;QACAA;QACAA;QAEAA;QACAA;QACAA;MACA;MACA;QACA+B;QACAY;MACA;MACAC;MAEA;QACA;QACA;MACA;QACA;QACA;UACAd;UACAC;QACA;QACA;QACA;QACA;QACA;UACA;QACA;QACA;MACA;IACA;IACAc;MACA;MACAC;IACA;IACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;IAEAC;MACA;QACA;MACA;MACAhD;MACAiD;MACA;QACA;MACA;MACA;IACA;IAEAC;MACA;QACA;MACA;MACAlD;MACAiD;MACA;QACA;MACA;MACA;IACA;IAEAE;MACA;IACA;IACAC;MACA;MACA;MACA;IACA;IACAC;MACA;MACA;MACA;MAEA;MACA;MACA;MACA;MACA;MAEA;MAEA;MAEA;MACA;IACA;IACAC;MACA;MACA;IACA;IACAC;MACAhB;IACA;IACAiB;MACA;MACA;MACA;MACA;IACA;EACA;AACA","names":["url","endpointCodes","name","data","urlr","status","message","descr","id_category","id_type","price","more_pro","cat_name","type_name","sub_name","id_subcategory","subcat","itemsub","search_value","updsearchcli","price_ext","descr_ext","extras","active","active2","value1","value2","value3","archivo","file1","viewModal","created","watch","id","option","computed","added","categorias","subcategorias","methods","wait","setTimeout","addSubcategory","submit","image","p","item","console","closeSelect","document","includesItem","search","includesItem2","showModal","closeModal","Add","toEdit","back","previewFiles"],"sourceRoot":"src/views/products","sources":["addPrd.vue"],"sourcesContent":["<template>\r\n  <div id=\"AddPrd\">\r\n    <div class=\"form-content\">\r\n      <form>\r\n        <section v-if=\"added !== ''\">\r\n          <div class=\"grup-form\"> \r\n            <p class=\"add_it\">Nombre: <span>{{ added.name }}</span></p>\r\n            <p class=\"add_it\">Descripción: <span>{{ added.descr }}</span></p>\r\n            <p class=\"add_it\">Categoría: <span>{{ added.category_name }}</span></p> \r\n            <img\r\n              class=\"img_item\"\r\n              v-if=\"added.image !== ''\" \r\n              :src=\"urlr + '/' + endpointCodes.get + '/product-img/' + added.image\"\r\n              alt=\"\"\r\n            />\r\n          </div>\r\n          <hr class=\"hrdr\" />          \r\n        </section>\r\n\r\n\r\n        \r\n        <div class=\"grup-form dflx\" v-if=\"added == ''\">\r\n          <!--nombre-->\r\n          <div class=\"boxform\">\r\n            <label for=\"name\" class=\"name\">Nombre </label>\r\n            <input\r\n              v-model=\"name\"\r\n              type=\"text\"\r\n              id=\"name\"\r\n              name=\"name\"\r\n              required\r\n              class=\"in1\"\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"grup-form dflx\" v-if=\"added == ''\">\r\n          <!--descripcion-->\r\n          <div class=\"boxform\">\r\n            <label for=\"descr\" class=\"descr\"\r\n              >Descripción <span class=\"opcional\">(opcional)</span></label\r\n            >\r\n            <textarea v-model=\"descr\" id=\"descr\" name=\"descr\" class=\"in1\" />\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"grup-form dflx\" v-if=\"added == ''\">\r\n          <!--categoría-->\r\n          <div class=\"boxform\">\r\n            <label for=\"category\" class=\"role\">Categoría</label>\r\n\r\n            <input\r\n              v-model=\"cat_name\"\r\n              type=\"text\"\r\n              id=\"category\"\r\n              name=\"category\"\r\n              disabled\r\n              required\r\n            />\r\n\r\n            <div class=\"content-tbl-items\">\r\n              <div class=\"tblitems\">\r\n                <div class=\"bodytbl-items tbl_item\">\r\n                  <div v-if=\"categorias.length > 0\">\r\n                    <div v-for=\"(prm, key) in categorias\" :key=\"key\">\r\n                      <p\r\n                        v-if=\"includesItem(value1, prm.name)\"\r\n                        class=\"itemp cp\"\r\n                        @click=\"(cat_name = prm.name), (id_category = prm.id)\"\r\n                      >\r\n                        {{ prm.name }}\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                  <div v-else>\r\n                    <p class=\"item cp\">No se encontraron coincidencias.</p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div class=\"buscador-items dflx\">\r\n                <input\r\n                  v-model=\"value1\"\r\n                  type=\"search\"\r\n                  id=\"inputbusqueda\"\r\n                  class=\"form-control searching-it\"\r\n                  :placeholder=\"'Búsqueda'\"\r\n                />\r\n                <div class=\"icon_buscar\">\r\n                  <img\r\n                    src=\"../../assets/default/Search.png\"\r\n                    alt=\"icono buscar\"\r\n                  />\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <!--type-->\r\n          <!-- <div class=\"boxform\">\r\n            <label for=\"role\" class=\"role\">Presentación</label>\r\n\r\n            <input\r\n              v-model=\"type_name\"\r\n              type=\"text\"\r\n              id=\"tipos\"\r\n              name=\"tipos\"\r\n              disabled\r\n              required\r\n            />\r\n\r\n            <div class=\"content-tbl-items\">\r\n              <div class=\"tblitems\">\r\n                <div class=\"bodytbl-items tbl_item\">\r\n                  <div\r\n                    v-if=\"\r\n                      type.length>0\r\n                    \"\r\n                  >\r\n                    <div v-for=\"(prm, key) in type\" :key=\"key\">\r\n                      <p\r\n                        v-if=\"includesItem2(value2, prm.name)\"\r\n                        class=\"itemp cp\"\r\n                        @click=\"(type_name = prm.name), (id_type = prm.id)\"\r\n                      >\r\n                        {{ prm.name }}\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                  <div v-else>\r\n                    <p class=\"item cp\">No se encontraron coincidencias.</p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div class=\"buscador-items dflx\">\r\n                <input\r\n                  v-model=\"value2\"\r\n                  type=\"search\"\r\n                  id=\"inputbusqueda\"\r\n                  class=\"form-control searching-it\"\r\n                  :placeholder=\"'Búsqueda'\"\r\n                />\r\n                <div class=\"icon_buscar\">\r\n                  <img src=\"../../assets/default/Search.png\" alt=\"icono buscar\" />\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div> -->\r\n        </div>\r\n        <div class=\"grup-form dflx\" v-if=\"added == ''\">\r\n          <div class=\"boxform\">\r\n            <label for=\"role\" class=\"role\"\r\n              >Agregar variates del producto\r\n            </label>\r\n            <div class=\"two-options\">\r\n              <div class=\"dflx\">\r\n                <div\r\n                  class=\"to-btn\"\r\n                  @click=\"more_pro = 'SI'\"\r\n                  :class=\"{ active: more_pro == 'SI' }\"\r\n                >\r\n                  CON VARIANTES\r\n                </div>\r\n                <div\r\n                  class=\"to-btn\"\r\n                  @click=\"more_pro = 'NO'\"\r\n                  :class=\"{ active: more_pro == 'NO' }\"\r\n                >\r\n                  SIN VARIANTE\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <label for=\"role\" class=\"role adv2\" v-if=\"more_pro == 'SI'\">\r\n              **Agregar precio al momento de añadir atributo.\r\n            </label>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"grup-form dflx\">\r\n          <!--precio-->\r\n          <div class=\"boxform\" v-if=\"(added == '' ? more_pro == 'NO' : added.more_pro == 'NO')\">\r\n            <label for=\"price\" class=\"price\">Precio </label>\r\n            <input\r\n              v-model=\"price\"\r\n              type=\"number\"\r\n              id=\"price\"\r\n              name=\"price\"\r\n              min=\"1\"\r\n              step=\"any\"\r\n              required\r\n              class=\"in1\"\r\n            />\r\n          </div>\r\n\r\n          <div class=\"boxform\"  v-if=\"(added == '' ? added == '' : added.more_pro == 'NO')\">\r\n            <label>Imagen <span class=\"opcional\">(opcional)</span></label>\r\n            <div class=\"dflx\">\r\n              <label class=\"filelabel\" for=\"uploadimg\">\r\n                <span>Seleccionar Archivo</span></label\r\n              >\r\n              <label class=\"filelabelname tbl_item\" for=\"uploadimg\">\r\n                {{ archivo }}</label\r\n              >\r\n            </div>\r\n\r\n            <input\r\n              @change=\"previewFiles\"\r\n              type=\"file\"\r\n              id=\"uploadimg\"\r\n              name=\"uploadimg\"\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        <div>\r\n          <hr class=\"hrdr\" />\r\n          <p class=\"subtitle\">\r\n            Subcategoría <span class=\"opcional\">(opcional)</span>\r\n          </p>\r\n\r\n          <form @submit.prevent=\"addSubcategory(itemsub)\">\r\n            <div class=\"grup-form dflx\">\r\n              <!--categoría-->\r\n              <div class=\"boxform\">\r\n                <label for=\"category\" class=\"category\">Seleccionada</label>\r\n\r\n                <input\r\n                  v-model=\"sub_name\"\r\n                  type=\"text\"\r\n                  id=\"category\"\r\n                  name=\"category\"\r\n                  disabled\r\n                  required\r\n                />\r\n\r\n                <div class=\"content-tbl-items\">\r\n                  <div class=\"tblitems\">\r\n                    <div class=\"bodytbl-items tbl_item\">\r\n                      <div v-if=\"subcategorias.length > 0\">\r\n                        <div v-for=\"(prm, key) in subcategorias\" :key=\"key\">\r\n                          <p\r\n                            v-if=\"includesItem(value3, prm.name)\"\r\n                            class=\"itemp cp\"\r\n                            @click=\"\r\n                              (sub_name = prm.name),\r\n                                (id_subcategory = prm.id),\r\n                                (itemsub = prm)\r\n                            \"\r\n                          >\r\n                            <!--parent_cat_name-->\r\n                            {{ prm.name }}\r\n                          </p>\r\n                        </div>\r\n                      </div>\r\n                      <div v-else>\r\n                        <p class=\"item cp\">No se encontraron coincidencias.</p>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                  <div class=\"buscador-items dflx\">\r\n                    <input\r\n                      v-model=\"value3\"\r\n                      type=\"search\"\r\n                      id=\"inputbusqueda\"\r\n                      class=\"form-control searching-it\"\r\n                      :placeholder=\"'Búsqueda'\"\r\n                    />\r\n                    <div class=\"icon_buscar\">\r\n                      <img\r\n                        src=\"../../assets/default/Search.png\"\r\n                        alt=\"icono buscar\"\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class=\"dflx\">\r\n              <button class=\"alta\" type=\"submit\">Agregar</button>\r\n            </div>\r\n          </form>\r\n\r\n          <div class=\"tabla_perzonalidada\">\r\n            <div class=\"header_tp\">\r\n              <p class=\"op_tp\">Subcategoría</p>\r\n              <p class=\"op_tp\">Categoría</p>\r\n              <p class=\"op_del_tb\">Eliminar</p>\r\n            </div>\r\n            <div class=\"body_tp\">\r\n              <div class=\"fila\" v-for=\"(item, key) in subcat\" :key=\"key\">\r\n                <p class=\"fp_tp\">{{ item.name }}</p>\r\n                <p class=\"fp_tp\">{{ item.category_name }}</p>\r\n                <p @click=\"subcat = []\" class=\"fdel\">&#10006;</p>\r\n              </div>\r\n              <div class=\"sinitems\" v-if=\"subcat.length == 0\">\r\n                <p>Sin subcategoría agregada</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!--<hr class=\"hrdr\" />\r\n        <p class=\"subtitle\">Extras <span class=\"opcional\">(opcional)</span></p>\r\n\r\n        <form @submit.prevent=\"addExtra(price_ext, descr_ext)\">\r\n          <div class=\"grup-form dflx\"> \r\n            <div class=\"boxform\">\r\n              <label for=\"price_ext\" class=\"price\">Precio </label>\r\n              <input\r\n                v-model=\"price_ext\"\r\n                type=\"number\"\r\n                id=\"price_ext\"\r\n                name=\"price_ext\"\r\n                min=\"1\"\r\n                step=\"any\"\r\n                required\r\n                class=\"in1\"\r\n              />\r\n            </div>\r\n          </div>\r\n          <div class=\"grup-form dflx\"> \r\n            <div class=\"boxform\">\r\n              <label for=\"descr_ext\" class=\"descr\">Descripción</label>\r\n              <textarea\r\n                v-model=\"descr_ext\"\r\n                id=\"descr\"\r\n                name=\"descr_ext\"\r\n                required\r\n                class=\"in1\"\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"dflx\">\r\n            <button class=\"alta\" type=\"submit\">Aceptar</button>\r\n          </div>\r\n        </form>\r\n\r\n        <div class=\"tabla_perzonalidada\">\r\n          <div class=\"header_tp\">\r\n            <p class=\"op_tp\">Descripción</p>\r\n            <p class=\"op_tp\">Precio</p>\r\n            <p class=\"op_del_tb\">Eliminar</p>\r\n          </div>\r\n          <div class=\"body_tp\">\r\n            <div class=\"fila\" v-for=\"(item, key) in extras\" :key=\"key\">\r\n              <p class=\"fp_tp\">{{ item.descr }}</p>\r\n              <p class=\"fp_tp\">${{ item.price }}</p>\r\n              <p @click=\"delExtra(key)\" class=\"fdel\">&#10006;</p>\r\n            </div>\r\n            <div class=\"sinitems\" v-if=\"extras.length == 0\">\r\n              <p>Sin extras agregados</p>\r\n            </div>\r\n          </div>\r\n        </div>-->\r\n\r\n        <!--regresar/guardar-->\r\n        <div class=\"dflx reg_gu_cont\">\r\n          <p @click=\"wait()\" class=\"btnRegresar\">Regresar</p>\r\n          <!--guardar primer producto-->\r\n          <div\r\n            class=\"alta\"\r\n            @click=\"\r\n              submit(\r\n                name,\r\n                id_category,\r\n                descr,\r\n                price,\r\n                file1,\r\n                extras,\r\n                subcat,\r\n                more_pro\r\n              )\r\n            \"\r\n            v-if=\"added == ''\"\r\n          >\r\n            Guardar\r\n          </div>\r\n          <!--guardar otro producto-->\r\n          <div\r\n            class=\"alta\"\r\n            @click=\"\r\n              submit(\r\n                added.name,\r\n                added.id_category,\r\n                added.descr,\r\n                price,\r\n                file1,\r\n                extras,\r\n                subcat,\r\n                added.more_pro\r\n              )\r\n            \"\r\n            v-else\r\n          >\r\n            Guardar\r\n          </div>\r\n        </div>\r\n\r\n        <div v-if=\"status != ''\" class=\"status_messages\">\r\n          <div v-if=\"status == 'success'\" class=\"msg msg_success\">\r\n            <p>{{ message }}</p>\r\n          </div>\r\n          <div v-if=\"status == 'error'\" class=\"msg msg_error\">\r\n            <p>{{ message }}</p>\r\n          </div>\r\n        </div>\r\n      </form>\r\n\r\n      <div v-if=\"viewModal\" class=\"modal_view\">\r\n        <div id=\"modal_add\">\r\n          <div class=\"body dflx\">\r\n            <h3>\r\n              Producto agregado con éxito. <br /><br />\r\n              <span>\r\n                Haz click en <b>continuar</b> para agregar <b><span v-if=\"more_pro == 'SI'\">atributo, </span>precio y stock.</b>\r\n              </span>\r\n            </h3>\r\n            <img src=\"../../assets/default/add.png\" alt=\"icono alerta\" />\r\n          </div>\r\n\r\n          <div class=\"modal_add_btns dflx\">\r\n            <!--<p @click=\"Add()\" class=\"otro\">Aceptar</p>-->\r\n            <p @click=\"toEdit()\" class=\"editar\">Continuar</p>\r\n            <p @click=\"back()\" class=\"inicio\">Regresar</p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { mapActions } from \"vuex\";\r\nlet { url, endpointCodes } = require(\"../../global/index\");\r\nexport default {\r\n  name: \"AddPrd\",\r\n  data() {\r\n    return {\r\n      urlr: url,\r\n      endpointCodes: endpointCodes,\r\n      status: \"\",\r\n      message: \"\",\r\n\r\n      name: \"\",\r\n      descr: \"\",\r\n      id_category: \"\",\r\n      id_type: \"\",\r\n      price: \"\",\r\n      more_pro: \"NO\",\r\n\r\n      cat_name: \"NINGUNA\",\r\n      type_name: \"NINGUNA\",\r\n\r\n      sub_name: \"NINGUNA\",\r\n      id_subcategory: \"\",\r\n      subcat: [],\r\n      itemsub: \"\",\r\n\r\n      url: \"\",\r\n\r\n      search_value: \"\",\r\n      updsearchcli: \"\",\r\n\r\n      price_ext: \"\",\r\n      descr_ext: \"\",\r\n      extras: [],\r\n\r\n      active: false,\r\n      active2: false,\r\n      value1: \"\",\r\n      value2: \"\",\r\n      value3: \"\",\r\n      archivo: \"No se eligió archivo\",\r\n      file1: null,\r\n\r\n      //MODAL\r\n\r\n      viewModal: false,\r\n    };\r\n  },\r\n  created() {\r\n    this.getAllInfoCtg(\"category\");\r\n    //this.getAllInfoTpe(\"type\");\r\n  },\r\n  watch: {\r\n    id_category: async function (value) {\r\n      this.subcat = [];\r\n      if (value) {\r\n        const payload2 = {\r\n          id: value,\r\n          option: \"category_subcategory\",\r\n        };\r\n        await this.getInfoByIdSct(payload2);\r\n      }\r\n    },\r\n  },\r\n\r\n  computed: {\r\n    added() {\r\n      return this.$store.getters[\"product/getAdded\"];\r\n    },\r\n    categorias() {\r\n      let arr = this.$store.getters[\"category/data\"];\r\n      if (Array.isArray(arr)) {\r\n        return arr;\r\n      } else {\r\n        return [];\r\n      }\r\n    },\r\n    subcategorias() {\r\n      let arr = this.$store.getters[\"subcategory/data\"];\r\n      if (Array.isArray(arr)) {\r\n        return arr;\r\n      } else {\r\n        return [];\r\n      }\r\n    },\r\n    /*type() {\r\n      let arr =  this.$store.getters[\"type/data\"];\r\n       if(Array.isArray(arr)){\r\n        return arr\r\n      }else{\r\n        return []\r\n      }\r\n    },*/\r\n  },\r\n  methods: {\r\n    ...mapActions(\"product\", [\"getAllInfoPrd\"]),\r\n    ...mapActions(\"product\", [\"setAddedPrd\"]),\r\n    ...mapActions(\"product\", [\"setHistoryOptionPrd\"]),\r\n    ...mapActions(\"product\", [\"getInfoByIdPrd\"]),\r\n    ...mapActions(\"category\", [\"getAllInfoCtg\"]),\r\n    ...mapActions(\"category\", [\"setAddedCtg\"]),\r\n    ...mapActions(\"category\", [\"setHistoryOptionCtg\"]),\r\n    ...mapActions(\"type\", [\"getAllInfoTpe\"]),\r\n    ...mapActions(\"type\", [\"setAddedTpe\"]),\r\n    ...mapActions(\"type\", [\"setHistoryOptionTpe\"]),\r\n    ...mapActions(\"subcategory\", [\"getInfoByIdSct\"]),\r\n    wait: function () {\r\n      setTimeout(() => this.$router.go(), 200);\r\n    },\r\n    addSubcategory(item) {\r\n      this.subcat = [item];\r\n      this.itemsub = \"\";\r\n      this.sub_name = \"NINGUNA\";\r\n      this.id_subcategory = \"\";\r\n    },\r\n    submit: async function (\r\n      name,\r\n      id_category,\r\n      descr,\r\n      price,\r\n      image,\r\n      extras,\r\n      subcat,\r\n      more_pro\r\n    ) {\r\n      this.status = \"\";\r\n      this.message = \"\";\r\n      let data = [];\r\n      extras = JSON.stringify(extras);\r\n      subcat = JSON.stringify(subcat);\r\n      let p = price;\r\n      if(more_pro == 'SI'){\r\n        p = 1\r\n      }\r\n      if (image == null) {\r\n        data = {\r\n          name: name,\r\n          id_category: id_category, \r\n          descr: descr,\r\n          price: p,\r\n          extras,\r\n          subcat,\r\n          more_pro,\r\n        };\r\n      } else {\r\n        data = new FormData();\r\n        data.append(\"name\", name);\r\n        data.append(\"id_category\", id_category);\r\n\r\n        data.append(\"descr\", descr);\r\n        data.append(\"price\", p);\r\n        data.append(\"image\", image);\r\n        data.append(\"subcat\", subcat);\r\n\r\n        data.append(\"extras\", extras);\r\n        data.append(\"more_pro\", more_pro);\r\n        data.append(\"_method\", \"POST\");\r\n      }\r\n      let result = await this.$store.dispatch(\"product/addItemPrd\", {\r\n        option: \"product\",\r\n        item: data,\r\n      });\r\n      console.log(result);\r\n\r\n      if (result.status == \"error\") {\r\n        this.status = \"error\";\r\n        this.message = result.message;\r\n      } else {\r\n        // success\r\n        let payload = {\r\n          id: result.added.id,\r\n          option: \"product\",\r\n        };\r\n        let arrl = await this.getInfoByIdPrd(payload);\r\n        this.setAddedPrd(arrl);\r\n        /**/\r\n        if (arrl.more_pro == true) {\r\n          this.active2 = true;\r\n        }\r\n        this.showModal();\r\n      }\r\n    },\r\n    closeSelect() {\r\n      this.active = false;\r\n      document.getElementById(\"select-ch\").checked = false;\r\n    },\r\n/* \r\n    addExtra(price, descr) {\r\n      let arr = [];\r\n      for (const item of this.extras) {\r\n        arr.push(item);\r\n      }\r\n      arr.push({\r\n        price,\r\n        descr,\r\n      });\r\n      this.extras = arr;\r\n    },\r\n    delExtra(indice) {\r\n      let arr = [];\r\n      for (var i = 0; i < this.extras.length; i++) {\r\n        if (i != indice) {\r\n          arr.push(this.extras[i]);\r\n        }\r\n      }\r\n      this.extras = arr;\r\n    },*/\r\n\r\n    includesItem(search, name) {\r\n      if (search == \"\") {\r\n        return true;\r\n      }\r\n      name = name.toLowerCase();\r\n      search = search.toLowerCase();\r\n      if (search == \"\") {\r\n        return false;\r\n      }\r\n      return name.includes(search);\r\n    },\r\n\r\n    includesItem2(search, name) {\r\n      if (search == \"\") {\r\n        return true;\r\n      }\r\n      name = name.toLowerCase();\r\n      search = search.toLowerCase();\r\n      if (search == \"\") {\r\n        return false;\r\n      }\r\n      return name.includes(search);\r\n    },\r\n\r\n    showModal: function () {\r\n      this.viewModal = true;\r\n    },\r\n    closeModal: function () {\r\n      this.viewModal = false;\r\n      this.setAddedPrd(\"\");\r\n      this.setHistoryOptionPrd(\"Default\");\r\n    },\r\n    Add: function () {\r\n      this.status = \"\";\r\n      this.message = \"\";\r\n      this.name = \"\";\r\n\r\n      this.id_category = \"\";\r\n      this.id_type = \"\";\r\n      this.cat_name = \"NINGUNA\";\r\n      this.type_name = \"NINGUNA\";\r\n      this.descr = \"\";\r\n\r\n      this.price = \"\";\r\n\r\n      this.file1 = null;\r\n\r\n      this.viewModal = false;\r\n      this.setAddedPrd(\"\");\r\n    },\r\n    toEdit: function () {\r\n      this.setHistoryOptionPrd(\"Edit\");\r\n      this.viewModal = false;\r\n    },\r\n    back: function () {\r\n      setTimeout(() => this.$router.go(), 200);\r\n    },\r\n    previewFiles(e) {\r\n      var files = e.target.files || e.dataTransfer.files;\r\n      if (!files.length) return;\r\n      this.file1 = files[0];\r\n      this.archivo = this.file1.name;\r\n    },\r\n  },\r\n};\r\n</script>\r\n<style scoped>\r\n.grup-form {\r\n  align-items: flex-start;\r\n}\r\n#AddPrd label {\r\n  color: var(--color-2);\r\n  font-weight: 700;\r\n  font-size: 0.7291666666666666vw;\r\n  margin-bottom: 0.3vw;\r\n}\r\n#AddPrd label.adv2{ \r\n  color: #afafaf;\r\n  margin: 1vw 0 2.3vw;\r\n}\r\n#AddPrd input,\r\n#AddPrd select {\r\n  height: 2.5vw;\r\n  width: 14.716666666666668vw;\r\n  border: 0.052083vw solid var(--color-2);\r\n  border-radius: 0vw 1.5vw 1.5vw 0vw;\r\n  color: var(--color-4);\r\n  font-size: 0.7291666666666666vw;\r\n  font-weight: 500;\r\n  padding-left: 1.09375vw;\r\n}\r\n\r\n#select-role {\r\n  height: 2.5vw;\r\n  width: 13.716667vw;\r\n  border: 0.052083vw solid var(--color-2);\r\n  border-radius: 0vw 1.5vw 1.5vw 0vw;\r\n  color: var(--color-4);\r\n  font-size: 0.7291666666666666vw;\r\n  font-weight: 500;\r\n  padding-left: 1.09375vw;\r\n  display: flex;\r\n  align-items: center;\r\n  background-image: url(\"../../assets/default/blueflecha.svg\");\r\n  background-repeat: no-repeat;\r\n  background-position-y: center;\r\n  background-position-x: 12.6vw;\r\n}\r\n#select-role.rounded {\r\n  border-radius: 0vw 1.5vw 0vw 0vw;\r\n  border-left: 0.052083vw solid var(--color-2);\r\n  border-right: 0.052083vw solid var(--color-2);\r\n  border-top: 0.052083vw solid var(--color-2);\r\n  border-bottom: 0;\r\n}\r\n#select-ch:checked ~ .options-cont {\r\n  display: flex;\r\n  position: absolute;\r\n  padding: 0.573vw 1.25vw;\r\n  flex-direction: column;\r\n  background-color: white;\r\n  width: 12.3vw;\r\n  border-left: 0.052083vw solid var(--color-2);\r\n  border-right: 0.052083vw solid var(--color-2);\r\n  border-top: 0;\r\n  border-bottom: 0.052083vw solid var(--color-2);\r\n}\r\n#modal_add .body {\r\n  height: 6.395833vw !important;\r\n}\r\n#modal_add img {\r\n  padding-top: 2.54vw !important;\r\n  padding-left: 1vw !important;\r\n}\r\n#modal_add h3 {\r\n  padding-top: 1.1177083vw !important;\r\n  width: 12vw !important;\r\n}\r\np.add_it {\r\n    color: var(--color-2);\r\n    font-weight: 700;\r\n    font-size: 0.7291666666666666vw;\r\n    margin-bottom: 0.3vw;\r\n}\r\np.add_it span {\r\n    color: silver;\r\n}\r\nimg.img_item{\r\n  margin-top: 1vw;\r\n    border-radius: 1.2vw;\r\n}\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}